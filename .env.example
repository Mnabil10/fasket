# --- Required ---
NODE_ENV=development
PORT=4000
API_PREFIX=api
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/fasket?schema=public

JWT_ACCESS_SECRET=replace-with-strong-secret
JWT_REFRESH_SECRET=replace-with-strong-secret
JWT_ACCESS_TTL=900
JWT_REFRESH_TTL=1209600
SIGNUP_SESSION_SECRET=replace-with-strong-secret
BCRYPT_ROUNDS=12
SIGNUP_SESSION_TTL_SECONDS=900

# CORS (comma separated origins)
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:8100
# Optional CORS helpers
CORS_DEV_ORIGINS=
CORS_ALLOW_LOCALHOST=true

# Uploads
UPLOADS_DRIVER=local # or s3
UPLOADS_DIR=uploads
UPLOAD_ALLOWED_MIME=image/jpeg,image/png,image/webp
UPLOAD_MAX_BYTES=10485760
LOCAL_UPLOADS_BASE_URL=http://localhost:4000/uploads

# If UPLOADS_DRIVER=s3
S3_ENDPOINT=https://s3.amazonaws.com
S3_REGION=
S3_BUCKET=your-bucket
S3_ACCESS_KEY_ID=your-key
S3_SECRET_ACCESS_KEY=your-secret
S3_PUBLIC_BASE_URL=
S3_FORCE_PATH_STYLE=false
S3_SSE=

# Cache / Redis
REDIS_ENABLED=true
REDIS_URL=redis://localhost:6379
CACHE_DEFAULT_TTL=60
CATEGORIES_CACHE_TTL=60
PRODUCT_LIST_CACHE_TTL=60
HOME_CACHE_TTL=120
BULK_PRODUCT_BATCH_SIZE=25

# Rate limiting / auth hardening
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100
AUTH_BRUTE_TTL=300
AUTH_BRUTE_MAX=5
AUTH_REQUIRE_ADMIN_2FA=false
AUTH_ADMIN_STATIC_OTP=123456  # Static OTP fallback for admins (use only for staging/dev)

# Automation / webhooks
AUTOMATION_WEBHOOK_URL=https://automation.fasket.cloud/webhook/fasket-events
AUTOMATION_HMAC_SECRET=replace-with-strong-secret
AUTOMATION_WEBHOOK_SECRET=replace-with-strong-secret
AUTOMATION_ALLOWED_IPS=127.0.0.1
AUTOMATION_WORKER_CONCURRENCY=5

# OTP / password reset
OTP_SECRET=change-me-otp-secret
OTP_ENABLED=true
OTP_TTL_MIN=5
OTP_TTL_SECONDS=180
OTP_TTL_SECONDS_TEST=5
OTP_MAX_ATTEMPTS=5
OTP_LOCK_MINUTES=15
OTP_RATE_LIMIT_SECONDS=60
OTP_MAX_PER_DAY=10
OTP_PER_IP_LIMIT=20
RESET_TOKEN_TTL_SECONDS=900

# WhatsApp (Meta)
WHATSAPP_ENABLED=true
WHATSAPP_PROVIDER=meta # meta or mock
WHATSAPP_ACCESS_TOKEN=replace-with-whatsapp-access-token
WHATSAPP_PHONE_NUMBER_ID=replace-with-whatsapp-phone-number-id
WHATSAPP_VERIFY_TOKEN=replace-with-whatsapp-verify-token
WHATSAPP_WEBHOOK_SECRET=replace-with-whatsapp-webhook-secret
WHATSAPP_API_VERSION=v20.0
WHATSAPP_API_BASE_URL=https://graph.facebook.com
WHATSAPP_DEFAULT_LANGUAGE=ar

# Push notifications
PUSH_PROVIDER=fcm # fcm | onesignal | mock
FCM_SERVER_KEY=
ONESIGNAL_REST_KEY=
ONESIGNAL_APP_ID=
WEB_PUSH_PUBLIC_KEY=
WEB_PUSH_PRIVATE_KEY=
WEB_PUSH_SUBJECT=mailto:notifications@fasket.shop
NOTIFICATION_BATCH_SIZE=500

# Internal automation / telegram
INTERNAL_SECRET=replace-with-strong-internal-secret
INTERNAL_TELEGRAM_SECRET=replace-with-internal-telegram-secret
TELEGRAM_LINK_TOKEN_TTL_MIN=10
TELEGRAM_BOT_USERNAME=FasketSuberBot
TELEGRAM_OTP_WEBHOOK_URL=
TELEGRAM_OTP_WEBHOOK_SECRET=
N8N_SEND_TELEGRAM_OTP_URL=https://automation.fasket.cloud/webhook/send-telegram-otp
N8N_SECRET=replace-with-n8n-secret

# Security
ENFORCE_HTTPS=false # set true in production
SWAGGER_ENABLED=true
SWAGGER_BASIC_USER=admin
SWAGGER_BASIC_PASS=admin

# Logging / Observability
LOG_LEVEL=debug
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=
SENTRY_PROFILES_SAMPLE_RATE=

# Routing / Maps
DELIVERY_DISTANCE_ENABLED=false
ROUTING_BASE_URL=http://localhost:5000
ROUTING_TIMEOUT_MS=2500
ROUTING_FALLBACK_SPEED_KPH=25

# Orders cache & watcher
ORDER_LIST_CACHE_TTL=30
ORDER_RECEIPT_CACHE_TTL=60
GUEST_ORDERS_ENABLED=true
ORDER_STUCK_WATCHER=true
ORDER_STUCK_SCAN_MINUTES=5
ORDER_STUCK_PENDING_MINUTES=30
ORDER_STUCK_CONFIRMED_MINUTES=60
ORDER_STUCK_PREPARING_MINUTES=90
ORDER_STUCK_OUT_FOR_DELIVERY_MINUTES=120

# Bootstrap defaults (scripts/bootstrap-marketplace.js)
DEFAULT_DELIVERY_RATE_PER_KM_CENTS=200
DEFAULT_MIN_DELIVERY_FEE_CENTS=1000
DEFAULT_MAX_DELIVERY_FEE_CENTS=5000
DEFAULT_PLAN_MONTHLY_AMOUNT_CENTS=0
DEFAULT_PLAN_YEARLY_AMOUNT_CENTS=0
DEFAULT_PLAN_MONTHLY_COMMISSION_BPS=500
DEFAULT_PLAN_YEARLY_COMMISSION_BPS=500
DEFAULT_PLAN_TRIAL_DAYS=14
DEFAULT_BRANCH_LAT=
DEFAULT_BRANCH_LNG=

# Analytics (ClickHouse)
CLICKHOUSE_URL=http://localhost:8123
CLICKHOUSE_DB=fasket_analytics
CLICKHOUSE_USER=
CLICKHOUSE_PASSWORD=
CLICKHOUSE_TIMEOUT_MS=3000
